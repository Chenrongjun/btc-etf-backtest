# 比特币 ETF 对比特币收益的sample预测研究  

本项目研究比特币 ETF 资金流动是否对比特币价格具有预测性，并基于此构建交易策略。  

## 目录  
- [项目简介](#项目简介)  
- [数据获取](#数据获取)  
- [数据分析](#数据分析)  
- [策略设计](#策略设计)  
- [回测结果](#回测结果)  

---

## 项目简介  
本研究探索了比特币 ETF（如 GBTC、IBIT 等）的资金流动与比特币价格变动之间的关系，并设计了一个基于 ETF 资金流向的交易策略。  

### 代码文件说明  
- **`analyse.py`** - 数据分析  
- **`backtest.py`** - 简单回测系统  

---

## 数据获取  
数据源及预处理方法如下：  
- **比特币价格数据**：来自 CoinGecko，日频数据  
- **ETF 资金流动数据**：来自 Farside，日频数据  

---

## 数据分析  

### 数据清洗与合并  
- 交易性考虑：T 日零点可获得 T-1 日的 ETF 数据，因此 ETF 日期需 **向后平移 1 天**（`shift(1D)`）  
- 关键变量：  
  - **`daily_return`**：T 到 T+1 的日收益率  
  - **`Vol_20d`**：T 到 T+20 的日频波动率  

### ETF 资金流与比特币价格关系  

#### 1. 资金流动与价格变动相关性  
- **总体相关性**：比特币 ETF 资金流入与 BTC 价格变化的相关系数为 **-0.97%**（无显著性）  
- **细分分析**：  
  - **GBTC 资金流入** 与 BTC 预期收益显著 **正相关 15%**  
  - **IBIT 资金流入** 与 BTC 预期收益显著 **负相关 -8%**  

📊 **ETF 资金流 vs. BTC 价格变动**  
![ETF 资金流相关性](https://github.com/user-attachments/assets/21e6083e-d6b0-4c67-93fb-632a8738749a)  

#### 2. ETF 资金流的 Lead-Lag 关系  
- T-1 ETF 净流入 vs. T 到 T+1 收益：**负相关 14%**  
- T-5 ETF 净流入 vs. T 到 T+1 收益：**正相关 13%**  
- T ETF 净流入 vs. T-1 到 T 收益：**正相关 30%**（没有交易性，或需要很及时的信息）  

📊 **Lead-Lag 分析**  
![Lead-Lag 分析](https://github.com/user-attachments/assets/43074b29-6db3-4ae9-b60d-e800254fdfbf)  

#### 3. ETF 资金流与 BTC 波动性  
- **短期波动率影响**：Corr_20d = -7%  ETF 净流出可能导致 BTC 短期波动率上升  
- **长期影响不显著**：Corr_60d = -1%

---

## 策略设计  

### 策略逻辑  
- 研究发现：  
  - **IBIT 资金流入** 与 BTC **预期收益显著负相关（-8%）**  
  - 资金流入 IBIT 时，BTC 价格可能 **承压**  
  - 资金流出 IBIT 时，BTC 价格可能 **上涨**  

### 交易信号  
- **做多（买入）**：IBIT 资金净流出  
- **平仓/做空**：IBIT 资金净流入  

### 风控与仓位管理  
- **止损**：入场后 BTC 价格 **下跌 10%** 平仓  
- **止盈**：BTC 价格 **上涨 20%** 全部平仓  

### 进一步研究  
- **交易信号优化**：基于历史资金流动强度决定仓位大小  
- **数据优化**：跟踪 ETF 资金流的具体生产时间，优化交易时段  
- **止盈止损优化**：评估不同参数对收益的影响  

**策略风险**  
- **数据挖掘风险**：需在样本外跟踪表现  
- **单因子局限**：IBIT 资金流仅为单一因子，需结合更多信息  

---

## 回测结果  

📊 **回测收益曲线**  
![Backtest Results](https://github.com/user-attachments/assets/df88f1ec-4fd4-4348-b73a-44d480b2e426)  

### 观察总结  
- 由于长期 ETF 资金流入，**大部分时间 signal = -1.0（空仓）**  
- 缺乏日内数据，止盈止损机制 **触发率低**（仅 2025.3.11 触发一次止损）  
- **相较于 Buy & Hold**，策略能 **降低回撤**，但 **收益能力较弱，胜率较低**  

---

## 结论  
本研究探讨了比特币 ETF 资金流对 BTC 价格的预测性，发现 **IBIT 资金流入与 BTC 价格呈负相关**，并基于此构建交易策略。初步回测显示策略有 **降低回撤的能力**，但 **需要进一步优化** 交易信号与止盈止损机制，以提升收益能力。  

---

## 如何运行代码  
```bash

# 运行数据分析
python analyse.py

# 运行回测
python backtest.py
